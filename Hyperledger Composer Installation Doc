Hyperledger Composer
Ref: https://stackoverflow.com/questions/49730300/no-version-of-composer-cli-has-been-detected

Ref: https://hyperledger.github.io/composer/latest/installing/development-tools.html

1. Install windows-build-tools (Elevated permissions)

D:\hackathon\hyperledgerfabric\composer>npm install --global --production windows-build-tools

> windows-build-tools@3.0.1 postinstall C:\Users\wqyz4n\AppData\Roaming\npm\node_modules\windows-build-tools
> node ./dist/index.js

Downloading BuildTools_Full.exe
Downloading python-2.7.14.amd64.msi
[============================================>] 100.0% of 20.17 MB (1.97 MB/s)
Downloaded python-2.7.14.amd64.msi. Saved to C:\Users\wqyz4n\.windows-build-tools\python-2.7.14.amd64.msi.

Starting installation...
Launched installers, now waiting for them to finish.
This will likely take some time - please be patient!

Status from the installers:
---------- Visual Studio Build Tools ----------
Successfully installed Visual Studio Build Tools.
------------------- Python --------------------
Successfully installed Python 2.7

All done!

2. Install composer-cli

D:\hackathon\hyperledgerfabric\composer>npm install -g composer-cli

D:\hackathon\hyperledgerfabric\composer>npm install -g composer-rest-server

D:\hackathon\hyperledgerfabric\composer>npm install -g generator-hyperledger-composer

D:\hackathon\hyperledgerfabric\composer>npm install -g yo

=========
$ mkdir fabric-dev-servers && cd fabric-dev-servers

$ curl -O https://raw.githubusercontent.com/hyperledger/composer-tools/master/packages/fabric-dev-servers/fabric-dev-servers.tar.gz

$ tar -xvf fabric-dev-servers.tar.gz

=================
$ pwd
/d/hackathon/hyperledgerfabric/composer/fabric-dev-servers

$ ./startFabric.sh
Development only script for Hyperledger Fabric control
Running 'startFabric.sh'
FABRIC_VERSION is unset, assuming hlfv11
FABRIC_START_TIMEOUT is unset, assuming 15 (seconds)
Removing network composer_default
Network composer_default not found.
Creating network "composer_default" with the default driver
Creating ca.org1.example.com ... done
Creating orderer.example.com ... done
Creating couchdb             ... done
Creating peer0.org1.example.com ... error

ERROR: for peer0.org1.example.com  Cannot create container for service peer0.org1.example.com: b'Mo                                                                                                               unt denied:\nThe source path "\\\\var\\\\run:/host/var/run/"\nis not a valid Windows path'

ERROR: for peer0.org1.example.com  Cannot create container for service peer0.org1.example.com: b'Mo                                                                                                               unt denied:\nThe source path "\\\\var\\\\run:/host/var/run/"\nis not a valid Windows path'
Encountered errors while bringing up the project.


SOLUTION: Edit the docker-compose.yml
vi /d/hackathon/hyperledgerfabric/composer/fabric-dev-servers/fabric-scripts/hlfv11/composer/docker-compose.yml




-----

wqyz4n@pl1inpun0874nb MINGW64 /d/hackathon/hyperledgerfabric/composer/fabric-dev-servers
$ ./startFabric.sh
Development only script for Hyperledger Fabric control
Running 'startFabric.sh'
FABRIC_VERSION is unset, assuming hlfv11
FABRIC_START_TIMEOUT is unset, assuming 15 (seconds)
Removing network composer_default
Network composer_default not found.
Creating network "composer_default" with the default driver
Creating couchdb             ... done
Creating ca.org1.example.com ... done
Creating orderer.example.com ... done
Creating peer0.org1.example.com ... done
sleeping for 15 seconds to wait for fabric to complete start up
2018-06-22 16:31:23.518 UTC [msp] GetLocalMSP -> DEBU 001 Returning existing local MSP
2018-06-22 16:31:23.518 UTC [msp] GetDefaultSigningIdentity -> DEBU 002 Obtaining default signing identity
2018-06-22 16:31:23.519 UTC [channelCmd] InitCmdFactory -> INFO 003 Endorser and orderer connections initialized
Error: channel create configuration tx file not found open C:/Users/wqyz4n/AppData/Local/Programs/Git/etc/hyperledger/configtx/composer-channel.tx: no such file or directory
Usage:
  peer channel create [flags]

Flags:
  -c, --channelID string   In case of a newChain command, the channel ID to create.
  -f, --file string        Configuration transaction file generated by a tool such as configtxgen for submitting to orderer
  -t, --timeout int        Channel creation timeout (default 5)

Global Flags:$ winpty docker exec -it a79d97aa14a9 bash
      --cafile string                       Path to file containing PEM-encoded trusted certificate(s) for the ordering endpoint
      --certfile string                     Path to file containing PEM-encoded X509 public key to use for mutual TLS communication with the orderer endpoint
      --clientauth                          Use mutual TLS when communicating with the orderer endpoint
      --keyfile string                      Path to file containing PEM-encoded private key to use for mutual TLS communication with the orderer endpoint
      --logging-level string                Default logging level and overrides, see core.yaml for full syntax
  -o, --orderer string                      Ordering service endpoint
      --ordererTLSHostnameOverride string   The hostname override to use when validating the TLS connection to the orderer.
      --tls                                 Use TLS when communicating with the orderer endpoint
  -v, --version                             Display current version of fabric peer server


SOLUTION: CREATE CHANNEL AND JOIN PEER TO THE CHANNEL

wqyz4n@pl1inpun0874nb MINGW64 /d/hackathon/hyperledgerfabric/composer/fabric-dev-servers
$ docker ps -a
CONTAINER ID        IMAGE                                     COMMAND                  CREATED             STATUS              PORTS                                            NAMES
4cc42d848c16        hyperledger/fabric-peer:x86_64-1.1.0      "peer node start"        2 minutes ago       Up 2 minutes        0.0.0.0:7051->7051/tcp, 0.0.0.0:7053->7053/tcp   peer0.org1.example.com
589d36757478        hyperledger/fabric-ca:x86_64-1.1.0        "sh -c 'fabric-ca-se…"   2 minutes ago       Up 2 minutes        0.0.0.0:7054->7054/tcp                           ca.org1.example.com
a79d97aa14a9        hyperledger/fabric-orderer:x86_64-1.1.0   "orderer"                2 minutes ago       Up 2 minutes        0.0.0.0:7050->7050/tcp                           orderer.example.com
e865adb04508        hyperledger/fabric-couchdb:x86_64-0.4.6   "tini -- /docker-ent…"   2 minutes ago       Up 2 minutes        4369/tcp, 9100/tcp, 0.0.0.0:5984->5984/tcp       couchdb



----


$ winpty docker exec -it 4cc42d848c16 bash

root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# peer channel create -o orderer.example.com:7050 -c composerchannel -f /etc/hyperledger/configtx/composer-channel.tx
2018-06-22 16:40:01.887 UTC [msp] GetLocalMSP -> DEBU 001 Returning existing local MSP
2018-06-22 16:40:01.887 UTC [msp] GetDefaultSigningIdentity -> DEBU 002 Obtaining default signing identity
2018-06-22 16:40:01.888 UTC [channelCmd] InitCmdFactory -> INFO 003 Endorser and orderer connections initialized
2018-06-22 16:40:01.893 UTC [msp] GetLocalMSP -> DEBU 004 Returning existing local MSP
2018-06-22 16:40:01.893 UTC [msp] GetDefaultSigningIdentity -> DEBU 005 Obtaining default signing identity
2018-06-22 16:40:01.893 UTC [msp] GetLocalMSP -> DEBU 006 Returning existing local MSP
2018-06-22 16:40:01.894 UTC [msp] GetDefaultSigningIdentity -> DEBU 007 Obtaining default signing identity
2018-06-22 16:40:01.894 UTC [msp/identity] Sign -> DEBU 008 Sign: plaintext: 0AA2060A074F7267314D53501296062D...6D706F736572436F6E736F727469756D
2018-06-22 16:40:01.894 UTC [msp/identity] Sign -> DEBU 009 Sign: digest: CF4A57422E91DFA9A03DFB62D787FEA4A36138FD09264FFBF06D8F24AA2FA195
2018-06-22 16:40:01.894 UTC [msp] GetLocalMSP -> DEBU 00a Returning existing local MSP
2018-06-22 16:40:01.894 UTC [msp] GetDefaultSigningIdentity -> DEBU 00b Obtaining default signing identity
2018-06-22 16:40:01.895 UTC [msp] GetLocalMSP -> DEBU 00c Returning existing local MSP
2018-06-22 16:40:01.895 UTC [msp] GetDefaultSigningIdentity -> DEBU 00d Obtaining default signing identity
2018-06-22 16:40:01.895 UTC [msp/identity] Sign -> DEBU 00e Sign: plaintext: 0ADF060A1B08021A0608E1CCB4D90522...52454C618068CD9BA38A00F82EC8F6D6
2018-06-22 16:40:01.895 UTC [msp/identity] Sign -> DEBU 00f Sign: digest: A594588F37DF40FC8AFE0874D26904B32D9CCA63DE738A9D68F3EBB417F2BAE8
2018-06-22 16:40:01.938 UTC [msp] GetLocalMSP -> DEBU 010 Returning existing local MSP
2018-06-22 16:40:01.938 UTC [msp] GetDefaultSigningIdentity -> DEBU 011 Obtaining default signing identity
2018-06-22 16:40:01.938 UTC [msp] GetLocalMSP -> DEBU 012 Returning existing local MSP
2018-06-22 16:40:01.938 UTC [msp] GetDefaultSigningIdentity -> DEBU 013 Obtaining default signing identity
2018-06-22 16:40:01.938 UTC [msp/identity] Sign -> DEBU 014 Sign: plaintext: 0ADF060A1B08021A0608E1CCB4D90522...A5DFA3261FD112080A021A0012021A00
2018-06-22 16:40:01.938 UTC [msp/identity] Sign -> DEBU 015 Sign: digest: A4ED6B64CC7E240234C7E8D5AB011A392CEA9FF47A0674E2E2D11D3DF5BEDA3B
2018-06-22 16:40:01.939 UTC [channelCmd] readBlock -> DEBU 016 Got status: &{NOT_FOUND}
2018-06-22 16:40:01.939 UTC [msp] GetLocalMSP -> DEBU 017 Returning existing local MSP
2018-06-22 16:40:01.939 UTC [msp] GetDefaultSigningIdentity -> DEBU 018 Obtaining default signing identity
2018-06-22 16:40:01.940 UTC [channelCmd] InitCmdFactory -> INFO 019 Endorser and orderer connections initialized
2018-06-22 16:40:02.142 UTC [msp] GetLocalMSP -> DEBU 01a Returning existing local MSP
2018-06-22 16:40:02.142 UTC [msp] GetDefaultSigningIdentity -> DEBU 01b Obtaining default signing identity
2018-06-22 16:40:02.142 UTC [msp] GetLocalMSP -> DEBU 01c Returning existing local MSP
2018-06-22 16:40:02.142 UTC [msp] GetDefaultSigningIdentity -> DEBU 01d Obtaining default signing identity
2018-06-22 16:40:02.142 UTC [msp/identity] Sign -> DEBU 01e Sign: plaintext: 0ADF060A1B08021A0608E2CCB4D90522...1266886032D312080A021A0012021A00
2018-06-22 16:40:02.147 UTC [msp/identity] Sign -> DEBU 01f Sign: digest: A00FA49113796756EA279B5EB6D76CEB1E5553887631117CBFCF5A9BAF4F46E1
2018-06-22 16:40:02.151 UTC [channelCmd] readBlock -> DEBU 020 Received block: 0
2018-06-22 16:40:02.152 UTC [main] main -> INFO 021 Exiting.....

root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# ps -ef | grep channel
root         40     23  0 16:40 pts/0    00:00:00 grep --color=auto channel
root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# ps -ef | grep configtx
root         42     23  0 16:40 pts/0    00:00:00 grep --color=auto configtx
root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# echo $CORE_PEER_MSPCONFIGPATH
/etc/hyperledger/peer/msp
root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# CORE_PEER_MSPCONFIGPATH=/etc/hyperledger/msp/users/Admin@org1.example.com/msp
root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# echo $CORE_PEER_MSPCONFIGPATH
/etc/hyperledger/msp/users/Admin@org1.example.com/msp

root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric# peer channel join -b composerchannel.block
2018-06-22 16:41:51.255 UTC [msp] GetLocalMSP -> DEBU 001 Returning existing local MSP
2018-06-22 16:41:51.255 UTC [msp] GetDefaultSigningIdentity -> DEBU 002 Obtaining default signing identity
2018-06-22 16:41:51.257 UTC [channelCmd] InitCmdFactory -> INFO 003 Endorser and orderer connections initialized
2018-06-22 16:41:51.258 UTC [msp/identity] Sign -> DEBU 004 Sign: plaintext: 0A9F070A5B08011A0B08CFCDB4D90510...59011AD6DDA51A080A000A000A000A00
2018-06-22 16:41:51.258 UTC [msp/identity] Sign -> DEBU 005 Sign: digest: 99EE505818121A8F36012150FB6A594CA92B27AC068A200909E88302A5C4FD08
2018-06-22 16:41:51.434 UTC [channelCmd] executeJoin -> INFO 006 Successfully submitted proposal to join channel
2018-06-22 16:41:51.434 UTC [main] main -> INFO 007 Exiting.....
root@4cc42d848c16:/opt/gopath/src/github.com/hyperledger/fabric#



==============

STARTING COMPOSER-PLAYGROUND

$ composer-playground
C:\Users\wqyz4n\AppData\Roaming\npm\node_modules\composer-playground\cli.js:47
(async function main() {
       ^^^^^^^^

SyntaxError: Unexpected token function
    at createScript (vm.js:56:10)
    at Object.runInThisContext (vm.js:97:10)
    at Module._compile (module.js:542:28)
    at Object.Module._extensions..js (module.js:579:10)
    at Module.load (module.js:487:32)
    at tryModuleLoad (module.js:446:12)
    at Function.Module._load (module.js:438:3)
    at Module.runMain (module.js:604:10)
    at run (bootstrap_node.js:389:7)
    at startup (bootstrap_node.js:149:9)


$ node.exe --version
v6.11.3



SOLUTION: Pre-requisties Node: 8.9 or higher (note version 9 is not supported)
Ref:https://hyperledger.github.io/composer/latest/installing/installing-prereqs.html

Download NodeJS version v8.11.3
https://nodejs.org/download/release/v8.11.3/
https://nodejs.org/download/release/v8.11.3/node-v8.11.3-x86.msi

wqyz4n@pl1inpun0874nb MINGW64 ~/AppData/Roaming/npm/node_modules/composer-playground
$ node --version
v8.11.3

===

wqyz4n@pl1inpun0874nb MINGW64 /d/hackathon/hyperledgerfabric/composer/fabric-dev                                                                                                                                  -servers
$ ./createPeerAdminCard.sh
Cannot find composer-cli


Ref: https://stackoverflow.com/questions/49730300/no-version-of-composer-cli-has-been-detected
SOLUTION: REINSTALL COMPOSER-CLI version 0.19.0

wqyz4n@pl1inpun0874nb MINGW64 /d/hackathon/hyperledgerfabric/composer/fabric-dev                                                                                                                                  -servers
$ ./createPeerAdminCard.sh
Development only script for Hyperledger Fabric control
Running 'createPeerAdminCard.sh'
FABRIC_VERSION is unset, assuming hlfv11
FABRIC_START_TIMEOUT is unset, assuming 15 (seconds)

Using composer-cli at v0.19.0

Successfully created business network card file to
        Output file: C:/Temp/PeerAdmin@hlfv1.card

Command succeeded


Successfully imported business network card
        Card file: C:/Temp/PeerAdmin@hlfv1.card
        Card name: PeerAdmin@hlfv1

Command succeeded

The following Business Network Cards are available:

Connection Profile: hlfv1
┌─────────────────┬───────────┬──────────────────┐
│ Card Name       │ UserId    │ Business Network │
├─────────────────┼───────────┼──────────────────┤
│ PeerAdmin@hlfv1 │ PeerAdmin │                  │
└─────────────────┴───────────┴──────────────────┘


Issue composer card list --card <Card Name> to get details a specific card

Command succeeded

Hyperledger Composer PeerAdmin card has been imported, host of fabric specified                                                                                                                                   as 'localhost